!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ForProgress=e():t.ForProgress=e()}(this,(function(){return(()=>{"use strict";var t={476:(t,e,r)=>{r.r(e),r.d(e,{default:()=>a});var n=r(81),s=r.n(n),o=r(645),i=r.n(o)()(s());i.push([t.id,"div.forProgressContainer{position:fixed;top:0;left:0;width:100%;z-index:999999999;transition:opacity 500ms 250ms}div.forProgressContainer div.bar{transition:transform 250ms cubic-bezier(0.25, 1, 0.5, 1);transform:translate3d(-100%, 0px, 0px);position:relative;width:100%}div.forProgressContainer div.bar div.tip{height:100%;width:95px;position:absolute;right:0;transform:rotate(4deg) translate3d(0px, -3px, 0px);filter:blur(5px)}.disableTransitionForProgress{transition:none !important}",""]);const a=i.toString()},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,s,o){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(n)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(i[c]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);n&&i[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),s&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=s):l[4]="".concat(s)),e.push(l))}},e}},81:t=>{t.exports=function(t){return t[1]}},450:function(t,e,r){const n=(this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}})(r(476));t.exports=class{constructor(t={}){this.settings={color:"red",autoIncrement:!0,autoIncrementSpeed:100,autoIncrementMaxPercent:1,autoIncrementFirstPercent:10,height:3,appendTo:"body",useCustomCss:!1},this.updateSettings(t),this.appendCss(),this.colorArray=this.getcolorArray(),this.currentPercent=0,this.currentAutoIncrementInterval=!1,this.isRunning=!1,this.autoIncrementIsPaused=!1}start(){this.reset();let{forProgressContainer:t,bar:e}=this.getForProgressElements();return t.classList.add("disableTransitionForProgress"),e.classList.add("disableTransitionForProgress"),this.setPercent(0),t.style.opacity="1",t.offsetHeight,t.classList.remove("disableTransitionForProgress"),e.classList.remove("disableTransitionForProgress"),this.startIncrement(),this}setPercent(t){return this.isRunning||this.start(),t<0||t>100||this.changeBarProgress(t),this}addPercent(t){this.isRunning||this.start();let e=this.currentPercent+t;return e>100&&(e=100),e<0&&(e=0),this.changeBarProgress(e),this}getPercent(){return this.currentPercent}done(){if(!this.isRunning)return this;let{forProgressContainer:t}=this.getForProgressElements();return this.clearCurrentAutoIncrementInterval(),this.setPercent(100),t.style.opacity="0",this.isRunning=!1,this}pause(){return this.autoIncrementIsPaused=!0,this}resume(){return this.autoIncrementIsPaused=!1,this}reset(){this.clearCurrentAutoIncrementInterval(),this.isRunning=!0,this.currentAutoIncrementInterval=!1,this.autoIncrementIsPaused=!this.settings.autoIncrement}changeBarProgress(t){let{bar:e}=this.getForProgressElements(),r=-100+t;e.style.transform=`translate3d(${r}%, 0px, 0px)`,this.currentPercent=t}createForProgressContainer(){let t=document.createElement("div");t.className="forProgressContainer";let e=document.createElement("div");e.className="bar";let r=document.createElement("div");return r.className="tip",e.append(r),t.append(e),e.style.background=this.gradientGenerator(),r.style.background=this.colorArray[this.colorArray.length-1],e.style.height=`${this.settings.height}px`,t}gradientGenerator(){return`linear-gradient(95deg, ${this.colorArray.map(((t,e)=>`${t} ${(100/(this.colorArray.length-1)*e).toFixed(2)}%`)).join(", ")})`}getcolorArray(){let t=this.settings.color;return"string"==typeof t?[t,t]:1===t.length?[t[0],t[0]]:t}getForProgressElements(){let t=document.querySelector("div.forProgressContainer");if(!t){t=this.createForProgressContainer();let e=document.querySelector(this.settings.appendTo);if(!e)throw`Cannot append to '${this.settings.appendTo}' as it does not exist in document`;e.append(t)}let e=t.querySelector("div.bar");return{forProgressContainer:t,bar:e}}startIncrement(){0!==this.currentPercent||this.autoIncrementIsPaused||this.setPercent(this.settings.autoIncrementFirstPercent),this.currentAutoIncrementInterval=setInterval((()=>{if(this.autoIncrementIsPaused)return;if(0===this.currentPercent&&0!==this.settings.autoIncrementFirstPercent)return void this.setPercent(this.settings.autoIncrementFirstPercent);let t=this.currentPercent+this.getRandomPercent();t<=99.5&&this.setPercent(t)}),this.settings.autoIncrementSpeed)}getRandomPercent(){return parseFloat((Math.random()*(.1-this.settings.autoIncrementMaxPercent)+this.settings.autoIncrementMaxPercent).toFixed(2))}updateSettings(t){for(let[e,r]of Object.entries(t))this.settings[e]=r}clearCurrentAutoIncrementInterval(){"number"==typeof this.currentAutoIncrementInterval&&clearInterval(this.currentAutoIncrementInterval)}appendCss(){if(this.settings.useCustomCss)return;let t=document.createElement("style");t.textContent=n.default,document.head.append(t)}}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={id:n,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}return r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(450)})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBR3JCLElBQUlDLEVBQVMrRixFQUF5QkUsR0FBWSxDQUNqRDNGLEdBQUkyRixFQUVKbEcsUUFBUyxJQU9WLE9BSEFvRyxFQUFvQkYsR0FBVUcsS0FBS3BHLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNpRyxHQUdwRWhHLEVBQU9ELFEsT0NwQmZpRyxFQUFvQkssRUFBS3JHLElBQ3hCLElBQUlzRyxFQUFTdEcsR0FBVUEsRUFBT3VHLFdBQzdCLElBQU92RyxFQUFpQixRQUN4QixJQUFNLEVBRVAsT0FEQWdHLEVBQW9CUSxFQUFFRixFQUFRLENBQUVHLEVBQUdILElBQzVCQSxHQ0xSTixFQUFvQlEsRUFBSSxDQUFDekcsRUFBUzJHLEtBQ2pDLElBQUksSUFBSW5CLEtBQU9tQixFQUNYVixFQUFvQlcsRUFBRUQsRUFBWW5CLEtBQVNTLEVBQW9CVyxFQUFFNUcsRUFBU3dGLElBQzVFRSxPQUFPbUIsZUFBZTdHLEVBQVN3RixFQUFLLENBQUVzQixZQUFZLEVBQU1DLElBQUtKLEVBQVduQixNQ0ozRVMsRUFBb0JXLEVBQUksQ0FBQ0ksRUFBS0MsSUFBVXZCLE9BQU93QixVQUFVQyxlQUFlZCxLQUFLVyxFQUFLQyxHQ0NsRmhCLEVBQW9CbUIsRUFBS3BILElBQ0gsb0JBQVhxSCxRQUEwQkEsT0FBT0MsYUFDMUM1QixPQUFPbUIsZUFBZTdHLEVBQVNxSCxPQUFPQyxZQUFhLENBQUU3QixNQUFPLFdBRTdEQyxPQUFPbUIsZUFBZTdHLEVBQVMsYUFBYyxDQUFFeUYsT0FBTyxLQ0Y3QlEsRUFBb0IsTSIsInNvdXJjZXMiOlsid2VicGFjazovL0ZvclByb2dyZXNzL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9Gb3JQcm9ncmVzcy8uL3NyYy9Gb3JQcm9ncmVzcy5zY3NzIiwid2VicGFjazovL0ZvclByb2dyZXNzLy4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly9Gb3JQcm9ncmVzcy8uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9ub1NvdXJjZU1hcHMuanMiLCJ3ZWJwYWNrOi8vRm9yUHJvZ3Jlc3MvLi9zcmMvRm9yUHJvZ3Jlc3MudHMiLCJ3ZWJwYWNrOi8vRm9yUHJvZ3Jlc3Mvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vRm9yUHJvZ3Jlc3Mvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vRm9yUHJvZ3Jlc3Mvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0ZvclByb2dyZXNzL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vRm9yUHJvZ3Jlc3Mvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9Gb3JQcm9ncmVzcy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiRm9yUHJvZ3Jlc3NcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiRm9yUHJvZ3Jlc3NcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfTk9fU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL25vU291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKF9fX0NTU19MT0FERVJfQVBJX05PX1NPVVJDRU1BUF9JTVBPUlRfX18pO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwiZGl2LmZvclByb2dyZXNzQ29udGFpbmVye3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO3otaW5kZXg6OTk5OTk5OTk5O3RyYW5zaXRpb246b3BhY2l0eSA1MDBtcyAyNTBtc31kaXYuZm9yUHJvZ3Jlc3NDb250YWluZXIgZGl2LmJhcnt0cmFuc2l0aW9uOnRyYW5zZm9ybSAyNTBtcyBjdWJpYy1iZXppZXIoMC4yNSwgMSwgMC41LCAxKTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoLTEwMCUsIDBweCwgMHB4KTtwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlfWRpdi5mb3JQcm9ncmVzc0NvbnRhaW5lciBkaXYuYmFyIGRpdi50aXB7aGVpZ2h0OjEwMCU7d2lkdGg6OTVweDtwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDowO3RyYW5zZm9ybTpyb3RhdGUoNGRlZykgdHJhbnNsYXRlM2QoMHB4LCAtM3B4LCAwcHgpO2ZpbHRlcjpibHVyKDVweCl9LmRpc2FibGVUcmFuc2l0aW9uRm9yUHJvZ3Jlc3N7dHJhbnNpdGlvbjpub25lICFpbXBvcnRhbnR9XCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IF9fX0NTU19MT0FERVJfRVhQT1JUX19fLnRvU3RyaW5nKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuLypcbiAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcbiAgQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcpIHtcbiAgdmFyIGxpc3QgPSBbXTsgLy8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xuXG4gIGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHZhciBjb250ZW50ID0gXCJcIjtcbiAgICAgIHZhciBuZWVkTGF5ZXIgPSB0eXBlb2YgaXRlbVs1XSAhPT0gXCJ1bmRlZmluZWRcIjtcblxuICAgICAgaWYgKGl0ZW1bNF0pIHtcbiAgICAgICAgY29udGVudCArPSBcIkBzdXBwb3J0cyAoXCIuY29uY2F0KGl0ZW1bNF0sIFwiKSB7XCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbVsyXSkge1xuICAgICAgICBjb250ZW50ICs9IFwiQG1lZGlhIFwiLmNvbmNhdChpdGVtWzJdLCBcIiB7XCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAobmVlZExheWVyKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJAbGF5ZXJcIi5jb25jYXQoaXRlbVs1XS5sZW5ndGggPiAwID8gXCIgXCIuY29uY2F0KGl0ZW1bNV0pIDogXCJcIiwgXCIge1wiKTtcbiAgICAgIH1cblxuICAgICAgY29udGVudCArPSBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0pO1xuXG4gICAgICBpZiAobmVlZExheWVyKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJ9XCI7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJ9XCI7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtWzRdKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJ9XCI7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH0pLmpvaW4oXCJcIik7XG4gIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG5cblxuICBsaXN0LmkgPSBmdW5jdGlvbiBpKG1vZHVsZXMsIG1lZGlhLCBkZWR1cGUsIHN1cHBvcnRzLCBsYXllcikge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgbW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgdW5kZWZpbmVkXV07XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblxuICAgIGlmIChkZWR1cGUpIHtcbiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdGhpcy5sZW5ndGg7IGsrKykge1xuICAgICAgICB2YXIgaWQgPSB0aGlzW2tdWzBdO1xuXG4gICAgICAgIGlmIChpZCAhPSBudWxsKSB7XG4gICAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2sgPSAwOyBfayA8IG1vZHVsZXMubGVuZ3RoOyBfaysrKSB7XG4gICAgICB2YXIgaXRlbSA9IFtdLmNvbmNhdChtb2R1bGVzW19rXSk7XG5cbiAgICAgIGlmIChkZWR1cGUgJiYgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBsYXllciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBpZiAodHlwZW9mIGl0ZW1bNV0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICBpdGVtWzVdID0gbGF5ZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbVsxXSA9IFwiQGxheWVyXCIuY29uY2F0KGl0ZW1bNV0ubGVuZ3RoID4gMCA/IFwiIFwiLmNvbmNhdChpdGVtWzVdKSA6IFwiXCIsIFwiIHtcIikuY29uY2F0KGl0ZW1bMV0sIFwifVwiKTtcbiAgICAgICAgICBpdGVtWzVdID0gbGF5ZXI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG1lZGlhKSB7XG4gICAgICAgIGlmICghaXRlbVsyXSkge1xuICAgICAgICAgIGl0ZW1bMl0gPSBtZWRpYTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtWzFdID0gXCJAbWVkaWEgXCIuY29uY2F0KGl0ZW1bMl0sIFwiIHtcIikuY29uY2F0KGl0ZW1bMV0sIFwifVwiKTtcbiAgICAgICAgICBpdGVtWzJdID0gbWVkaWE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHN1cHBvcnRzKSB7XG4gICAgICAgIGlmICghaXRlbVs0XSkge1xuICAgICAgICAgIGl0ZW1bNF0gPSBcIlwiLmNvbmNhdChzdXBwb3J0cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbVsxXSA9IFwiQHN1cHBvcnRzIChcIi5jb25jYXQoaXRlbVs0XSwgXCIpIHtcIikuY29uY2F0KGl0ZW1bMV0sIFwifVwiKTtcbiAgICAgICAgICBpdGVtWzRdID0gc3VwcG9ydHM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gbGlzdDtcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGkpIHtcbiAgcmV0dXJuIGlbMV07XG59OyIsImltcG9ydCBjc3MgZnJvbSAnLi9Gb3JQcm9ncmVzcy5zY3NzJztcblxuaW50ZXJmYWNlIFNldHRpbmdzIHtcbiAgICBjb2xvcj86IHN0cmluZyB8IHN0cmluZ1tdICYgeyAwOiBzdHJpbmcgfTtcbiAgICBhdXRvSW5jcmVtZW50PzogYm9vbGVhbjtcbiAgICBhdXRvSW5jcmVtZW50U3BlZWQ/OiBudW1iZXI7XG4gICAgYXV0b0luY3JlbWVudE1heFBlcmNlbnQ/OiBudW1iZXI7XG4gICAgYXV0b0luY3JlbWVudEZpcnN0UGVyY2VudD86IG51bWJlcjtcbiAgICBoZWlnaHQ/OiBudW1iZXI7XG4gICAgYXBwZW5kVG8/OiBzdHJpbmc7XG4gICAgdXNlQ3VzdG9tQ3NzPzogYm9vbGVhbjtcbn1cblxuY2xhc3MgRm9yUHJvZ3Jlc3Mge1xuXG4gICAgcHJpdmF0ZSBzZXR0aW5nczogUmVxdWlyZWQ8U2V0dGluZ3M+O1xuICAgIHByaXZhdGUgY3VycmVudFBlcmNlbnQ6IG51bWJlcjtcbiAgICBwcml2YXRlIGN1cnJlbnRBdXRvSW5jcmVtZW50SW50ZXJ2YWw6IG51bWJlciB8IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBpc1J1bm5pbmc6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBhdXRvSW5jcmVtZW50SXNQYXVzZWQ6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBjb2xvckFycmF5OiBzdHJpbmdbXTtcblxuICAgIGNvbnN0cnVjdG9yKGN1c3RvbVNldHRpbmdzOiBTZXR0aW5ncyA9IHt9KSB7XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHtcbiAgICAgICAgICAgIGNvbG9yOiAncmVkJyxcbiAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWUsXG4gICAgICAgICAgICBhdXRvSW5jcmVtZW50U3BlZWQ6IDEwMCxcbiAgICAgICAgICAgIGF1dG9JbmNyZW1lbnRNYXhQZXJjZW50OiAxLFxuICAgICAgICAgICAgYXV0b0luY3JlbWVudEZpcnN0UGVyY2VudDogMTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDMsXG4gICAgICAgICAgICBhcHBlbmRUbzogJ2JvZHknLFxuICAgICAgICAgICAgdXNlQ3VzdG9tQ3NzOiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudXBkYXRlU2V0dGluZ3MoY3VzdG9tU2V0dGluZ3MpO1xuICAgICAgICB0aGlzLmFwcGVuZENzcygpO1xuICAgICAgICB0aGlzLmNvbG9yQXJyYXkgPSB0aGlzLmdldGNvbG9yQXJyYXkoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50UGVyY2VudCA9IDA7XG4gICAgICAgIHRoaXMuY3VycmVudEF1dG9JbmNyZW1lbnRJbnRlcnZhbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmF1dG9JbmNyZW1lbnRJc1BhdXNlZCA9IGZhbHNlO1xuXG4gICAgfVxuXG4gICAgLyoqIFxuICAgICAqIFN0YXJ0IHRoZSBwcm9ncmVzcyBiYXIuIFJlc3RhcnRzIGlmIGFscmVhZHkgcnVubmluZy5cbiAgICAgKiBAcGFyYW0gYXV0b0luY3JlbWVudCBFbmFibGUgb3IgZGlzYWJsZSBhdXRvIGluY3JlbWVudC4gT3ZlcnJpZGVzIHRoZSBzZXR0aW5ncyBhdXRvSW5jcmVtZW50IHByb3BlcnR5LlxuICAgICAqL1xuICAgIHN0YXJ0KCk6IHRoaXMge1xuXG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBsZXQgeyBmb3JQcm9ncmVzc0NvbnRhaW5lciwgYmFyIH0gPSB0aGlzLmdldEZvclByb2dyZXNzRWxlbWVudHMoKTtcblxuICAgICAgICBmb3JQcm9ncmVzc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlVHJhbnNpdGlvbkZvclByb2dyZXNzJyk7XG4gICAgICAgIGJhci5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlVHJhbnNpdGlvbkZvclByb2dyZXNzJyk7XG5cbiAgICAgICAgdGhpcy5zZXRQZXJjZW50KDApO1xuICAgICAgICBmb3JQcm9ncmVzc0NvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuXG4gICAgICAgIGZvclByb2dyZXNzQ29udGFpbmVyLm9mZnNldEhlaWdodDtcbiAgICAgICAgZm9yUHJvZ3Jlc3NDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZVRyYW5zaXRpb25Gb3JQcm9ncmVzcycpO1xuICAgICAgICBiYXIuY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZVRyYW5zaXRpb25Gb3JQcm9ncmVzcycpO1xuXG4gICAgICAgIHRoaXMuc3RhcnRJbmNyZW1lbnQoKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hbnVhbGx5IHNldCB0aGUgcGVyY2VudCBvZiB0aGUgcHJvZ3Jlc3MgYmFyLlxuICAgICAqL1xuICAgIHNldFBlcmNlbnQocGVyY2VudDogbnVtYmVyKTogdGhpcyB7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgdGhpcy5zdGFydCgpO1xuXG4gICAgICAgIGlmIChwZXJjZW50IDwgMCB8fCBwZXJjZW50ID4gMTAwKSByZXR1cm4gdGhpcztcblxuICAgICAgICB0aGlzLmNoYW5nZUJhclByb2dyZXNzKHBlcmNlbnQpO1xuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCB0byB0aGUgY3VycmVudCBwZWNlbnQgb2YgdGhlIHByb2dyZXNzIGJhci4gVXNlIHtAbGluayBnZXRQZXJjZW50fSB0byBnZXQgdGhlIGN1cnJlbnQgcGVyY2VudCB2YWx1ZS5cbiAgICAgKi9cbiAgICBhZGRQZXJjZW50KHBlcmNlbnQ6IG51bWJlcikge1xuXG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHRoaXMuc3RhcnQoKTtcblxuICAgICAgICBsZXQgbmV3UGVyY2VudCA9IHRoaXMuY3VycmVudFBlcmNlbnQgKyBwZXJjZW50O1xuICAgICAgICBpZiAobmV3UGVyY2VudCA+IDEwMCkgbmV3UGVyY2VudCA9IDEwMDtcbiAgICAgICAgaWYgKG5ld1BlcmNlbnQgPCAwKSBuZXdQZXJjZW50ID0gMDtcblxuICAgICAgICB0aGlzLmNoYW5nZUJhclByb2dyZXNzKG5ld1BlcmNlbnQpO1xuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBwZXJjZW50IHZhbHVlIG9mIHRoZSBwcm9ncmVzcyBiYXIuXG4gICAgICovXG4gICAgZ2V0UGVyY2VudCgpOiBudW1iZXIge1xuXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRQZXJjZW50O1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvZ3Jlc3MgYmFyIHRvIDEwMCUgYW5kIGZhZGVzIG91dFxuICAgICAqL1xuICAgIGRvbmUoKTogdGhpcyB7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuIHRoaXM7XG5cbiAgICAgICAgbGV0IHsgZm9yUHJvZ3Jlc3NDb250YWluZXIgfSA9IHRoaXMuZ2V0Rm9yUHJvZ3Jlc3NFbGVtZW50cygpO1xuICAgICAgICB0aGlzLmNsZWFyQ3VycmVudEF1dG9JbmNyZW1lbnRJbnRlcnZhbCgpO1xuICAgICAgICB0aGlzLnNldFBlcmNlbnQoMTAwKTtcbiAgICAgICAgZm9yUHJvZ3Jlc3NDb250YWluZXIuc3R5bGUub3BhY2l0eSA9ICcwJztcblxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGF1c2UgYXV0byBpbmNyZW1lbnRhdGlvbiAoaWYgZW5hYmxlZCkuXG4gICAgICovXG4gICAgcGF1c2UoKTogdGhpcyB7XG5cbiAgICAgICAgdGhpcy5hdXRvSW5jcmVtZW50SXNQYXVzZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc3VtZSBhdXRvIGluY3JlbWVudGF0aW9uLlxuICAgICAqL1xuICAgIHJlc3VtZSgpOiB0aGlzIHtcblxuICAgICAgICB0aGlzLmF1dG9JbmNyZW1lbnRJc1BhdXNlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgIH1cblxuICAgIHByaXZhdGUgcmVzZXQoKSB7XG5cbiAgICAgICAgdGhpcy5jbGVhckN1cnJlbnRBdXRvSW5jcmVtZW50SW50ZXJ2YWwoKTtcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmN1cnJlbnRBdXRvSW5jcmVtZW50SW50ZXJ2YWwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hdXRvSW5jcmVtZW50SXNQYXVzZWQgPSAhdGhpcy5zZXR0aW5ncy5hdXRvSW5jcmVtZW50O1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjaGFuZ2VCYXJQcm9ncmVzcyhwZXJjZW50OiBudW1iZXIpIHtcblxuICAgICAgICBsZXQgeyBiYXIgfSA9IHRoaXMuZ2V0Rm9yUHJvZ3Jlc3NFbGVtZW50cygpO1xuXG4gICAgICAgIGxldCB0cmFuc2xhdGVQZXJjZW50ID0gLTEwMCArIHBlcmNlbnQ7XG4gICAgICAgIGJhci5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHt0cmFuc2xhdGVQZXJjZW50fSUsIDBweCwgMHB4KWA7XG5cbiAgICAgICAgdGhpcy5jdXJyZW50UGVyY2VudCA9IHBlcmNlbnQ7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUZvclByb2dyZXNzQ29udGFpbmVyKCk6IEhUTUxFbGVtZW50IHtcblxuICAgICAgICBsZXQgZm9yUHJvZ3Jlc3NDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZm9yUHJvZ3Jlc3NDb250YWluZXIuY2xhc3NOYW1lID0gJ2ZvclByb2dyZXNzQ29udGFpbmVyJztcblxuICAgICAgICBsZXQgYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGJhci5jbGFzc05hbWUgPSAnYmFyJztcblxuICAgICAgICBsZXQgdGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRpcC5jbGFzc05hbWUgPSAndGlwJztcblxuICAgICAgICBiYXIuYXBwZW5kKHRpcCk7XG4gICAgICAgIGZvclByb2dyZXNzQ29udGFpbmVyLmFwcGVuZChiYXIpO1xuXG4gICAgICAgIGJhci5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5ncmFkaWVudEdlbmVyYXRvcigpO1xuICAgICAgICB0aXAuc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JBcnJheVt0aGlzLmNvbG9yQXJyYXkubGVuZ3RoIC0gMV07XG4gICAgICAgIGJhci5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLnNldHRpbmdzLmhlaWdodH1weGA7XG5cbiAgICAgICAgcmV0dXJuIGZvclByb2dyZXNzQ29udGFpbmVyO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBncmFkaWVudEdlbmVyYXRvcigpOiBzdHJpbmcge1xuXG4gICAgICAgIGxldCBjb2xvclBvc1N0cmluZyA9IHRoaXMuY29sb3JBcnJheVxuICAgICAgICAgICAgLm1hcCgoY29sb3IsIGkpID0+IHtcblxuICAgICAgICAgICAgICAgIGxldCBncmFkaWVudFBvcyA9ICgoMTAwIC8gKHRoaXMuY29sb3JBcnJheS5sZW5ndGggLSAxKSkgKiBpKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHtjb2xvcn0gJHtncmFkaWVudFBvc30lYDtcblxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKCcsICcpO1xuXG4gICAgICAgIHJldHVybiBgbGluZWFyLWdyYWRpZW50KDk1ZGVnLCAke2NvbG9yUG9zU3RyaW5nfSlgO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRjb2xvckFycmF5KCk6IHN0cmluZ1tdIHtcblxuICAgICAgICBsZXQgY29sb3IgPSB0aGlzLnNldHRpbmdzLmNvbG9yO1xuXG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT09ICdzdHJpbmcnKSByZXR1cm4gW2NvbG9yLCBjb2xvcl07XG4gICAgICAgIGlmIChjb2xvci5sZW5ndGggPT09IDEpIHJldHVybiBbY29sb3JbMF0sIGNvbG9yWzBdXVxuICAgICAgICByZXR1cm4gY29sb3I7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEZvclByb2dyZXNzRWxlbWVudHMoKTogeyBmb3JQcm9ncmVzc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGJhcjogSFRNTEVsZW1lbnQgfSB7XG5cbiAgICAgICAgbGV0IGZvclByb2dyZXNzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZm9yUHJvZ3Jlc3NDb250YWluZXInKTtcblxuICAgICAgICBpZiAoIWZvclByb2dyZXNzQ29udGFpbmVyKSB7XG5cbiAgICAgICAgICAgIGZvclByb2dyZXNzQ29udGFpbmVyID0gdGhpcy5jcmVhdGVGb3JQcm9ncmVzc0NvbnRhaW5lcigpO1xuICAgICAgICAgICAgbGV0IGFwcGVuZFRvRWxlbWVudDogSFRNTEVsZW1lbnQgfCBudWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNldHRpbmdzLmFwcGVuZFRvKTtcbiAgICAgICAgICAgIGlmICghYXBwZW5kVG9FbGVtZW50KSB0aHJvdyBgQ2Fubm90IGFwcGVuZCB0byAnJHt0aGlzLnNldHRpbmdzLmFwcGVuZFRvfScgYXMgaXQgZG9lcyBub3QgZXhpc3QgaW4gZG9jdW1lbnRgO1xuICAgICAgICAgICAgYXBwZW5kVG9FbGVtZW50LmFwcGVuZChmb3JQcm9ncmVzc0NvbnRhaW5lcik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBiYXIgPSBmb3JQcm9ncmVzc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdkaXYuYmFyJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAgICAgcmV0dXJuIHsgZm9yUHJvZ3Jlc3NDb250YWluZXIsIGJhciB9O1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGFydEluY3JlbWVudCgpIHtcblxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGVyY2VudCA9PT0gMCAmJiAhdGhpcy5hdXRvSW5jcmVtZW50SXNQYXVzZWQpIHRoaXMuc2V0UGVyY2VudCh0aGlzLnNldHRpbmdzLmF1dG9JbmNyZW1lbnRGaXJzdFBlcmNlbnQpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudEF1dG9JbmNyZW1lbnRJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcblxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b0luY3JlbWVudElzUGF1c2VkKSByZXR1cm47XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQZXJjZW50ID09PSAwICYmIHRoaXMuc2V0dGluZ3MuYXV0b0luY3JlbWVudEZpcnN0UGVyY2VudCAhPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQZXJjZW50KHRoaXMuc2V0dGluZ3MuYXV0b0luY3JlbWVudEZpcnN0UGVyY2VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IG5leHRQZXJjZW50ID0gdGhpcy5jdXJyZW50UGVyY2VudCArIHRoaXMuZ2V0UmFuZG9tUGVyY2VudCgpO1xuICAgICAgICAgICAgaWYgKG5leHRQZXJjZW50IDw9IDk5LjUpIHRoaXMuc2V0UGVyY2VudChuZXh0UGVyY2VudCk7XG5cbiAgICAgICAgfSwgdGhpcy5zZXR0aW5ncy5hdXRvSW5jcmVtZW50U3BlZWQpIGFzIHVua25vd24gYXMgbnVtYmVyO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRSYW5kb21QZXJjZW50KCk6IG51bWJlciB7XG5cbiAgICAgICAgLy8gUmFuZG9tIG51bWJlciBiZXR3ZWVuIDAuMSBhbmQgdGhpcy5zZXR0aW5ncy5hdXRvSW5jcmVtZW50TWF4UGVyY2VudC5cbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoKE1hdGgucmFuZG9tKCkgKiAoMC4xIC0gdGhpcy5zZXR0aW5ncy5hdXRvSW5jcmVtZW50TWF4UGVyY2VudCkgKyB0aGlzLnNldHRpbmdzLmF1dG9JbmNyZW1lbnRNYXhQZXJjZW50KS50b0ZpeGVkKDIpKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlU2V0dGluZ3MoY3VzdG9tU2V0dGluZ3M6IFNldHRpbmdzKSB7XG5cbiAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGN1c3RvbVNldHRpbmdzKSkge1xuXG4gICAgICAgICAgICAodGhpcy5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGNsZWFyQ3VycmVudEF1dG9JbmNyZW1lbnRJbnRlcnZhbCgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmN1cnJlbnRBdXRvSW5jcmVtZW50SW50ZXJ2YWwgPT09ICdudW1iZXInKSBjbGVhckludGVydmFsKHRoaXMuY3VycmVudEF1dG9JbmNyZW1lbnRJbnRlcnZhbClcbiAgICB9XG5cbiAgICBwcml2YXRlIGFwcGVuZENzcygpIHtcblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VDdXN0b21Dc3MpIHJldHVybjtcblxuICAgICAgICBsZXQgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgc3R5bGVFbGVtZW50LnRleHRDb250ZW50ID0gY3NzO1xuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZChzdHlsZUVsZW1lbnQpO1xuXG4gICAgfVxuXG59O1xuXG5leHBvcnQgPSBGb3JQcm9ncmVzcztcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0aWQ6IG1vZHVsZUlkLFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNDUwKTtcbiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJ0aGlzIiwiX19fQ1NTX0xPQURFUl9FWFBPUlRfX18iLCJwdXNoIiwiaWQiLCJ0b1N0cmluZyIsImNzc1dpdGhNYXBwaW5nVG9TdHJpbmciLCJsaXN0IiwibWFwIiwiaXRlbSIsImNvbnRlbnQiLCJuZWVkTGF5ZXIiLCJjb25jYXQiLCJsZW5ndGgiLCJqb2luIiwiaSIsIm1vZHVsZXMiLCJtZWRpYSIsImRlZHVwZSIsInN1cHBvcnRzIiwibGF5ZXIiLCJ1bmRlZmluZWQiLCJhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzIiwiayIsIl9rIiwiY29uc3RydWN0b3IiLCJjdXN0b21TZXR0aW5ncyIsInNldHRpbmdzIiwiY29sb3IiLCJhdXRvSW5jcmVtZW50IiwiYXV0b0luY3JlbWVudFNwZWVkIiwiYXV0b0luY3JlbWVudE1heFBlcmNlbnQiLCJhdXRvSW5jcmVtZW50Rmlyc3RQZXJjZW50IiwiaGVpZ2h0IiwiYXBwZW5kVG8iLCJ1c2VDdXN0b21Dc3MiLCJ1cGRhdGVTZXR0aW5ncyIsImFwcGVuZENzcyIsImNvbG9yQXJyYXkiLCJnZXRjb2xvckFycmF5IiwiY3VycmVudFBlcmNlbnQiLCJjdXJyZW50QXV0b0luY3JlbWVudEludGVydmFsIiwiaXNSdW5uaW5nIiwiYXV0b0luY3JlbWVudElzUGF1c2VkIiwic3RhcnQiLCJyZXNldCIsImZvclByb2dyZXNzQ29udGFpbmVyIiwiYmFyIiwiZ2V0Rm9yUHJvZ3Jlc3NFbGVtZW50cyIsImNsYXNzTGlzdCIsImFkZCIsInNldFBlcmNlbnQiLCJzdHlsZSIsIm9wYWNpdHkiLCJvZmZzZXRIZWlnaHQiLCJyZW1vdmUiLCJzdGFydEluY3JlbWVudCIsInBlcmNlbnQiLCJjaGFuZ2VCYXJQcm9ncmVzcyIsImFkZFBlcmNlbnQiLCJuZXdQZXJjZW50IiwiZ2V0UGVyY2VudCIsImRvbmUiLCJjbGVhckN1cnJlbnRBdXRvSW5jcmVtZW50SW50ZXJ2YWwiLCJwYXVzZSIsInJlc3VtZSIsInRyYW5zbGF0ZVBlcmNlbnQiLCJ0cmFuc2Zvcm0iLCJjcmVhdGVGb3JQcm9ncmVzc0NvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInRpcCIsImFwcGVuZCIsImJhY2tncm91bmQiLCJncmFkaWVudEdlbmVyYXRvciIsInRvRml4ZWQiLCJxdWVyeVNlbGVjdG9yIiwiYXBwZW5kVG9FbGVtZW50Iiwic2V0SW50ZXJ2YWwiLCJuZXh0UGVyY2VudCIsImdldFJhbmRvbVBlcmNlbnQiLCJwYXJzZUZsb2F0IiwiTWF0aCIsInJhbmRvbSIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImNsZWFySW50ZXJ2YWwiLCJzdHlsZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImhlYWQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm4iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImEiLCJkZWZpbml0aW9uIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyJdLCJzb3VyY2VSb290IjoiIn0=